@page "/editBlog"
@using System.ComponentModel.DataAnnotations
@inject NavigationManager Navigation
@inject ApplicationDbContext _db;

<PageTitle>EditBlog</PageTitle>

<h3>EditBlog</h3>

<form method="post"  @OnSubmit="savePostAsync" @formname="blogForm">
	<AntiforgeryToken />
	@* <DataAnnotationsValidator />
	<ValidationSummary /> *@

	<div class="form-floating mb-3">
		<InputText @bind-Value="postModel!.Title" class="form-control" id="inp1" placeholder="Blíží se Jaro."/>
		<label for="inp1">Titulek</label>
	</div>
	<div class="form-floating mb-3">
		<InputText type="text" @bind-Value="postModel!.Text" class="form-control" id="inp2" placeholder="Už se otepluje a tráva..."/>
		<label for="inp2">Text</label>
	</div>
	<div class="form-check">
		<InputCheckbox type="checkbox" @bind-Value="postModel!.IsOnTop" class="form-check-input" id="flexCheckDefault"/>
		<label class="form-check-label" for="flexCheckDefault">
			Připnuto?
		</label>
	</div>
	<button type="submit" class="btn btn-outline-primary">Vytvořit příspěvek</button>
</form>



@code {
	// [SupplyParameterFromForm]
	private PostModel? postModel;

	protected override void OnInitialized() => postModel ??= new();

	async Task savePostAsync()
	{
		if(postModel.Title != null)
		{
			await _db.PostModels.AddAsync(postModel);
			await _db.SaveChangesAsync();
			Navigation.NavigateTo("/Blog");
		}
	}
}
